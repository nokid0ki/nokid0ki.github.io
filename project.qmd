---
title: Looking to rent a HDB flat in Singapore? 🏠
execute: 
  echo: false
format: html
editor: visual
---

We will investigate the average rental prices of HDB flats and its trends. The scope of this analysis involves rental prices between 2021 to 2023, covering 3 to 5 room flats. The data set used is publicly available [here](https://beta.data.gov.sg/collections/166/view)! 😆

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(sf)
library(mapview)
library(rvest)
library(httr)
library(dplyr)
library(leaflet)
```

```{r message=FALSE, warning=FALSE, echo=FALSE, results='hide'}

test <- read_sf(here::here("MP14_PLNG_AREA_NO_SEA_PL.kml"))

keke <- read_csv("RentingOutofFlats.csv", col_types = cols(
  rent_approval_date = col_character(),
  town = col_character(),
  block = col_character(),
  street_name = col_character(),
  flat_type = col_character(),
  monthly_rent = col_double()
))

rental <- keke %>%
  group_by(town) %>%
  summarize(mean_monthly_rent = mean(monthly_rent))

rental1 <- rental %>%
  rename(Name = town)

meep <- st_read(dsn = "MP14_PLNG_AREA_NO_SEA_PL.kml")

meep_sf <- st_as_sf(meep[c("Name", "geometry")])
meep_sf <- st_set_crs(meep_sf, 3414)

meep_sub <- meep_sf %>%
  select(geometry)

merged_data <- merge(meep_sf, rental1, by.x = "Name", by.y = "Name")

```

### A heat map of mean rental prices in each planning area📍
Hover over the area to view the planning area, and click upon it to view the mean rental price! (Edit: WIP in calculating mean per HDB type)

```{r message=FALSE, warning=FALSE, echo=FALSE}

merged_data <- meep_sf %>%
  left_join(rental1, by = c("Name" = "Name"))

popup_content <- sprintf(
  "Town: %s<br>Mean Monthly Rent: $%.2f",
  merged_data$Name,
  merged_data$mean_monthly_rent
)

heatmap_map <- mapview(merged_data, zcol = "mean_monthly_rent", label="Name", popup = popup_content, layer.name = 'Mean Rental Price (SGD)')


heatmap_map

```
### Distribution of different HDB types across planning areas 📊
Placeholder text

### Trend in rental prices over the 3 years 📈
Placeholder text




```{r}


```

```{r message=FALSE, warning=FALSE}


```

```         
```
